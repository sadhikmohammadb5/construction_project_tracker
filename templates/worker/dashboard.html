{% extends "layout.html" %}
{% block content %}

<h2>Worker Dashboard</h2>

<!-- ================= Assigned Work ================= -->
<div class="card">
    <h3>Assigned Work</h3>

    {% if assignments %}
    <table>
        <thead>
            <tr>
                <th>Project</th>
                <th>Task</th>
                <th>Instructions</th>
                <th>Due Date</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for task in assignments %}
            <tr>
                <td>{{ task.project.name if task.project else "—" }}</td>
                <td>{{ task.task_title }}</td>
                <td>{{ task.instructions }}</td>

                <td>{{ task.due_date or "—" }}</td>
                <td>
                    <span class="status {{ task.status|lower }}">
                        {{ task.status }}
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p style="color:#777;">No work assigned yet.</p>
    {% endif %}
</div>

<!-- ================= Attendance ================= -->
<div class="card">
    <h3>Today's Attendance</h3>

    {% if attendance_marked %}
        <p style="color:green;">Attendance already submitted for today.</p>
    {% else %}
    <form method="post" action="{{ url_for('mark_attendance') }}">
        <select name="status" required>
            <option value="">Select</option>
            <option value="Present">Present</option>
            <option value="Absent">Absent</option>
        </select>
        <button type="submit">Submit Attendance</button>
    </form>
    {% endif %}
</div>

<!-- ================= Work Log ================= -->
<div class="card">
    <h3>Daily Work Log</h3>

    <form method="post" action="{{ url_for('submit_work_log') }}">
        <textarea name="description"
                  placeholder="Describe today's completed work"
                  required></textarea>

        <input type="number"
               name="hours"
               placeholder="Hours Worked"
               min="1"
               max="24"
               required>

        <button type="submit">Submit Work Log</button>
    </form>
</div>

{% endblock %}
